@{
	ViewBag.Title = "Options";
	Layout = "~/Views/Shared/_Layout.cshtml";
}
<script type="text/javascript" src="~/App/Services/ProfileModuleService.js"></script>
<script type="text/javascript" src="~/App/Services/GeoDataModule.js"></script>
<script type="text/javascript" src="~/App/Validation/ProfileValidation.js"></script>
<script type="text/javascript" src="~/App/ProfileModule.js"></script>

<i class="fa fa-circle-o-notch fa-spin" style="font-size: 60px;color:red" data-bind="visible: !loaded"></i>
<div data-bind="visible: loaded">
	<h2>Мої налаштування</h2>
	<ul class="nav nav-tabs">
		<li class="active"><a href="#location" data-toggle="tab" aria-expanded="True">Контактні дані</a></li>
		<li class=""><a href="#changeEmail" data-toggle="tab">Change Email</a></li>
		<li class=""><a href="#changePassword" data-toggle="tab">Change Password</a></li>
		<li class=""><a href="#removeAccount" data-toggle="tab">Remove Account</a></li>
	</ul>
	<div id="tabContent" class="tab-content">

		<div class="tab-pane fade active in" id="location">
			<div class="form-horizontal" style="padding-top: 20px">
				<fieldset>

					<div class="form-group" data-bind="css: {'has-error': selectedCountry.isModified() && !selectedCountry.isValid()}">
						<label for="countries" class="col-lg-2 control-label">Країна</label>
						<div class="col-lg-3">
							<select class="form-control" id="countries"
									data-bind="options: countries,
                                           optionsText: 'title',
                                           optionsValue: 'id',
                                           optionsCaption: 'Select...',
                                           value: selectedCountry,
                                           event: {change: onCountryChange}"></select>

						</div>
						<div class="col-lg-1" data-bind="if: showRegionsSpinner">
							<i class="fa fa-circle-o-notch fa-spin col-lg-1" style="font-size: 24px; color: red"></i>
						</div>
						<div class="col-lg-3" data-bind="if: selectedCountry.isModified() && !selectedCountry.isValid()">
							<span class="label label-danger" data-bind="text: selectedCountry.validationMessage()"></span>
						</div>
					</div>

					<div class="form-group" data-bind="css: {'has-error': selectedRegion.isModified() && !selectedRegion.isValid()}">
						<label for="regions" class="col-lg-2 control-label">Область</label>
						<div class="col-lg-3">
							<select class="form-control" id="regions" data-bind="options: regions,
                                                                             enable: regionsLoaded,
                                                                             optionsText: 'title',
                                                                             optionsValue: 'id',
                                                                             optionsCaption: 'Select...',
                                                                             value: selectedRegion,
                                                                             event: {change: onRegionChange}"></select>
						</div>
						<div class="col-lg-1">
							<i class="fa fa-circle-o-notch fa-spin col-lg-1" style="font-size: 24px; color: red" data-bind="visible: showCitiesSpinner"></i>
						</div>
						<div class="col-lg-3" data-bind="if: selectedRegion.isModified() && !selectedRegion.isValid()">
							<span class="label label-danger" data-bind="text: selectedRegion.validationMessage()"></span>
						</div>
					</div>

					<div class="form-group" data-bind="css: {'has-error': selectedCity.isModified() && !selectedCity.isValid()}">
						<label for="cities" class="col-lg-2 control-label">Місто</label>
						<div class="col-lg-3">
							<select class="form-control" id="cities" data-bind="options: cities,
                                                                            enable: citiesLoaded,
                                                                            optionsText: 'title',
                                                                            optionsValue: 'id',
                                                                            optionsCaption: 'Select...',
                                                                            value: selectedCity"></select>
						</div>
						<div class="col-lg-3" data-bind="if: selectedCity.isModified() && !selectedCity.isValid()">
							<span class="label label-danger" data-bind="text: selectedCity.validationMessage()"></span>
						</div>
					</div>
					<div class="form-group" data-bind="css: {'has-error': name.isModified() && !name.isValid()}">
						<label for="name" class="col-lg-2 control-label">Контактна особа</label>
						<div class="col-lg-3">
							<input type="text" class="form-control" id="name" data-bind="value: name" placeholder="Ім'я" />
						</div>
						<div class="col-lg-3" data-bind="if: name.isModified() && !name.isValid()">
							<span class="label label-danger" data-bind="text: name.validationMessage()"></span>
						</div>
					</div>

					<div class="form-group" data-bind="css: {'has-error': phone.isModified() && !phone.isValid()}">
						<label for="phone" class="col-lg-2 control-label">Контактний телефон</label>
						<div class="col-lg-3">
							<input type="text" class="form-control" id="phone" data-bind="value: phone" placeholder="Телефон" />
						</div>
						<div class="col-lg-3" data-bind="if: phone.isModified() && !phone.isValid()">
							<span class="label label-danger" data-bind="text: phone.validationMessage()"></span>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-1 col-lg-offset-2">
							<button class="btn btn-primary" data-bind="event:{click: onSaveButtonClick}">Save</button>
						</div>
						<div class="col-lg-1">
							<i class="fa fa-circle-o-notch fa-spin col-lg-1" style="font-size: 24px; color: red" data-bind="visible: showSaveSpinner"></i>
						</div>
					</div>
				</fieldset>
			</div>
		</div>
		<div class="tab-pane fade" id="changeEmail">
			<div class="form-horizontal" style="padding-top: 20px">
				<fieldset>
					<div class="form-group">
						<label for="newEmail" class="col-lg-2 control-label">New Email</label>
						<div class="col-lg-3">
							<input type="text" class="form-control" id="newEmail" placeholder="New Email" data-bind="value: newEmail" />
						</div>

						<div class="col-lg-1">
							<button class="btn btn-primary" data-bind="click: onChangeEmailClick">Change Email</button>
						</div>
						<div class="col-lg-1">
							<i class="fa fa-circle-o-notch fa-spin col-lg-1" style="font-size: 24px; color: red" data-bind="visible: showEmailSpinner"></i>
						</div>
					</div>

					<div class="form-group" data-bind="visible: showConfirmMessage">
						<div class="alert alert-dismissible" data-bind="css: emailConfirmStyle">
							<button type="button" class="close" data-dismiss="alert">&times;</button>
							<strong data-bind="text: emailConfirmStrongMessage()"></strong>&nbsp;<span data-bind="text: emailConfirmMessage()"></span>
						</div>
					</div>
				</fieldset>
			</div>
		</div>

		<div class="tab-pane fade" id="changePassword">
			<div class="form-horizontal" style="padding-top: 20px">
				<fieldset>
					<div class="form-group" data-bind="css: {'has-error': password.isModified() && !password.isValid()}">
						<label for="password" class="col-lg-2 control-label">Old Password</label>
						<div class="col-lg-3">
							<input type="password" class="form-control"  id="password" placeholder="Old Password" data-bind="value: password"/>
						</div>
						<div class="col-lg-3" data-bind="visible: password.isModified() && !password.isValid()">
							<span data-bind="text: password.error()" class="label label-danger"></span>
						</div>
					</div>
					<div class="form-group" data-bind="css: {'has-error': newPassword.isModified() && !newPassword.isValid()}">
						<label for="newPassword" class="col-lg-2 control-label">New Password</label>
						<div class="col-lg-3">
							<input type="password" class="form-control" id="newPassword" placeholder="New Password" data-bind="value: newPassword" />
						</div>
						<div class="col-lg-3" data-bind="visible: newPassword.isModified() && !newPassword.isValid()">
							<span data-bind="text: newPassword.error()" class="label label-danger"></span>
						</div>
					</div>
					<div class="form-group" data-bind="css: {'has-error': confirmNewPassword.isModified() && !confirmNewPassword.isValid()}">
						<label for="confirmNewPassword" class="col-lg-2 control-label">Confirm New Password</label>
						<div class="col-lg-3">
							<input type="password" class="form-control" id="confirmNewPassword" placeholder="Confirm New Password" data-bind="value: confirmNewPassword" />
						</div>
						<div class="col-lg-3" data-bind="visible: confirmNewPassword.isModified() && !confirmNewPassword.isValid()">
							<span data-bind="text: confirmNewPassword.error()" class="label label-danger"></span>
						</div>
					</div>
					<div class="form-group">
						<div class="col-lg-2">
							<button class="btn btn-primary" data-bind="click: onChangePasswordClick">Change Password</button>
						</div>
						<div class="col-lg-1">
							<i class="fa fa-circle-o-notch fa-spin" style="font-size: 24px; color: red" data-bind="visible: showPasswordSpinner"></i>
						</div>
					</div>
					<div class="form-group" data-bind="visible: showPasswordMessage">
						<div class="alert alert-dismissible" data-bind="css: passwordConfirmStyle">
							<button type="button" class="close" data-dismiss="alert">&times;</button>
							<strong data-bind="text: passwordConfirmStrongMessage()"></strong>&nbsp;<span data-bind="text: passwordConfirmMessage()"></span>
						</div>
					</div>
				</fieldset>
			</div>
		</div>
		<div class="tab-pane fade" id="removeAccount">Remove account big button with confirmation</div>
	</div>

</div>
<script type="text/javascript">
	$(document).ready(function () {
		Window.App.ProfileModule.loadData();
	});
</script>